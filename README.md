# Gloamreach — StoryWorld

**Gloamreach** is a dark‑fantasy interactive story built with [Streamlit](https://streamlit.io) and OpenAI’s chat models. It generates narrative scenes and choices on the fly, tracking your decisions and their consequences across sessions. The game is designed to be middle‑school friendly (PG‑13) but still evokes a grim, mysterious world where magic comes at a cost.

---

## Features

- **Dynamic storytelling** — Narrative generated by OpenAI, guided by detailed lore in `lore.json`.
- **Player choices** — Each turn, you receive two imperative options, with consequences.
- **Risk & death system** — Tracks dangerous decisions and escalates peril; risky streaks can lead to character death.
- **Persistent sessions** — Player progress is stored in SQLite by default, or PostgreSQL/Neon if configured.
- **Custom UI** — Streamlit‑based frontend with animations, a lantern loader, and typewriter‑style text reveal.
- **Telemetry & logging** — Choice latency, danger streaks, and outcomes are recorded for analysis.

## Getting Started

### Prerequisites

- Python 3.9+
- [Streamlit](https://streamlit.io/)
- OpenAI API key

Install dependencies:

```bash
pip install -r requirements.txt
```

### Running the Game

```bash
streamlit run app.py
```

Once launched, the app will open in your browser. Players can enter their name, gender, and archetype before starting a new adventure in Gloamreach.

---

## Project Structure

```
StoryWorld/
├── app.py              # Main Streamlit app entry point
├── lore.json           # Defines game lore, factions, locations, relics
├── prompts.py          # Templates for system & user prompts
├── core/               # Identity management, logging
├── story/engine.py     # Story generation & choice logic
├── ui/                 # CSS, streaming, loader, and choice rendering
├── data/               # SQLite & Neon database storage backends
├── scripts/            # Dev/testing scripts (e.g., DB smoke test)
└── utils/              # Retry logic and helpers
```

---

## Database Persistence

- **Default:** SQLite database stored locally as `story.db`.
- **Optional:** Neon/Postgres by setting a `DATABASE_URL` environment variable.

Progress is stored in tables for `story_progress`, `story_visits`, and `story_events`.

---

## Customization

- **Lore:** Modify `lore.json` to change the world, factions, and rules.
- **Prompts:** Tweak `prompts.py` to alter narrative tone or structure.
- **UI:** Adjust styles in `ui/anim.py` or extend with new components.

---

## License

This project is released under the MIT License. See [LICENSE](LICENSE) for details.

